package com.ddt.testcases;

import org.testng.Assert;
import org.testng.annotations.Test;

import java.time.Duration;

import org.openqa.selenium.Alert;
import org.openqa.selenium.By;
import org.openqa.selenium.WebDriver;
import org.openqa.selenium.firefox.FirefoxDriver;
import org.openqa.selenium.interactions.Actions;
import org.openqa.selenium.support.ui.ExpectedCondition;
import org.openqa.selenium.support.ui.ExpectedConditions;
import org.openqa.selenium.support.ui.WebDriverWait;
import org.testng.annotations.Test;

import com.ddt.base.Base;
import com.ddt.rough.TestProperties;
import com.ddt.utilities.DataProviders;

public class TestCases extends Base {
	WebDriverWait wait;

	public TestCases() {
		super();
		// TODO Auto-generated constructor stub
	}

	@Test
	public void mgrLogin() throws InterruptedException {

		driver.get(TestProperties.configprop.getProperty("siteUrl"));
		//Thread.sleep(3000);
		//WebDriverWait wait = new WebDriverWait(driver, Duration.ofSeconds(10));
		//wait=new WebDriverWait(null, )
		Actions act = new Actions(driver);
		act.click();
		 wait=new WebDriverWait(driver,Duration.ofSeconds(Integer.parseInt(TestProperties.configprop.getProperty("wait"))));
		wait.until(ExpectedConditions.elementToBeClickable(
				driver.findElement(By.cssSelector(TestProperties.oRepoprop.getProperty("HPManagerLoginBtn")))));
		driver.findElement(By.cssSelector(TestProperties.oRepoprop.getProperty("HPManagerLoginBtn"))).click();
	      act.click();
	      Thread.sleep(2000);
	      driver.navigate().refresh();
		wait.until(ExpectedConditions.elementToBeClickable(
				driver.findElement(By.xpath(TestProperties.oRepoprop.getProperty("AddCustButton")))));
		driver.findElement(By.xpath(TestProperties.oRepoprop.getProperty("AddCustButton"))).click();
			Assert.assertTrue(isElementPresent(By.xpath(oRepoprop.getProperty("AddCustButton"))),
			"Login is not successfull");
	}

	@Test(dataProviderClass = DataProviders.class, dataProvider = "exceldp", dependsOnMethods = { "mgrLogin" })
	public void addCustomer(String FirstName, String LastName, String PostCode) throws InterruptedException {
		
		driver.manage().timeouts().implicitlyWait(Duration.ofSeconds(5));
		driver.findElement(By.xpath(TestProperties.oRepoprop.getProperty("AddCustButton"))).click();
		wait.until(ExpectedConditions.elementToBeClickable(driver.findElement(By.xpath(TestProperties.oRepoprop.getProperty("FirstNameTextBoxXpath")))));
		driver.findElement(By.xpath(TestProperties.oRepoprop.getProperty("FirstNameTextBoxXpath"))).sendKeys(FirstName);
		driver.findElement(By.cssSelector(TestProperties.oRepoprop.getProperty("LastNameTextBoxCss"))).sendKeys(LastName);
		driver.findElement(By.cssSelector(TestProperties.oRepoprop.getProperty("PostCodeTextBoxCss"))).sendKeys(PostCode);
		driver.findElement(By.xpath(TestProperties.oRepoprop.getProperty("AddCustomerButton"))).click();
		Alert alert =wait.until(ExpectedConditions.alertIsPresent());
		alert.accept();
		
	}
}
